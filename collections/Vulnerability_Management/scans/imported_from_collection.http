#!/usr/bin/env dothttp

# imported from 35240-b5ac5e35-5071-4a6b-95cc-a32753fe572d.postman_collection.json

// base-inherit-auth

@name("base-inherit-auth")
GET "https://"


// Creates a scan configuration. For more information and request body examples, see [Create a Scan](doc:create-scan-tio). 
// 
// **Note:** Tenable.io limits the number of scans you can create to 10,000 scans. Tenable recommends you re-use scheduled scans instead of creating new scans. An HTTP 403 error is returned if you attempt to create a scan after you have already reached the scan limit of 10,000.  <p>Requires SCAN OPERATOR [24] user permissions. See [Permissions](doc:permissions).</p>

@name("Create scan") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans"
"Content-Type": "application/json"
json({
    "uuid": "ab4bacd2-05f6-425c-9d79-3ba3940ad1c24e51e1f403febe40",
    "settings": {
        "name": "laboris",
        "enabled": false,
        "description": "in anim",
        "policy_id": 94784826,
        "folder_id": -50692118,
        "scanner_id": "00000000-0000-0000-0000-00000000000000000000000000001",
        "target_network_uuid": "00000000-0000-0000-0000-000000000000",
        "launch": "MONTHLY",
        "scan_time_window": -54369207,
        "starttime": "20140826T133000",
        "rrules": "culpa",
        "timezone": "America/New_York",
        "text_targets": "localhost",
        "target_groups": [
            -26946341,
            10871660
        ],
        "file_targets": "scan_targets.txt",
        "tag_targets": [
            "amet aliquip tempor",
            "magna com"
        ],
        "agent_group_id": [
            "cillum enim commodo minim",
            "cillum consectetur"
        ],
        "emails": "test1@test.com, test2@test.com",
        "acls": [
            {
                "permissions": 82035394,
                "owner": -51479824,
                "display_name": "cupidatat Lorem officia",
                "name": "consequat labore et proident id",
                "id": -21513822,
                "type": "dolore Lorem officia irure"
            },
            {
                "permissions": -38123473,
                "owner": 74754412,
                "display_name": "laborum velit ut",
                "name": "sint deserunt aliqua",
                "id": -55791816,
                "type": "consectetur"
            }
        ]
    },
    "credentials": {
        "add": {
            "Host": {
                "Windows": [
                    {
                        "domain": "eu nisi magna ad",
                        "username": "et fugiat incididunt sint",
                        "auth_method": "Password",
                        "password": "in minim labore non"
                    },
                    {
                        "domain": "consectetur mollit officia ipsum",
                        "username": "fugiat anim consectetur minim",
                        "auth_method": "Password",
                        "password": "commodo sed"
                    }
                ]
            }
        }
    },
    "plugins": {
        "Web Servers": {
            "individual": {
                "11213": "enabled",
                "18261": "enabled"
            }
        }
    }
})


// Returns a list of scans where you have at least CAN VIEW [16] permissions. 
// 
// **Note:** Keep in mind potential [rate limits](doc:rate-limiting) when using this endpoint. To check the status of your scans, use the [GET /scans/{scan_id}/latest-status](ref:scans-get-latest-status) endpoint. Tenable recommends the [GET /scans/{scan_id}/latest-status](ref:scans-get-latest-status) endpoint especially if you are programmatically checking the status of large numbers of scans.<p>Requires BASIC [16] user permissions and CAN VIEW [16] scan permissions. See [Permissions](doc:permissions).</p>

@name("List scans") : "base-inherit-auth"
GET "https://{{baseUrl}}/scans"
? "folder_id"= "67454373"
? "last_modification_date"= "67454373"


// Import an existing scan uploaded using the [Upload File](ref:file-upload) endpoint. Tenable.io supports scan imports up to 4 GB in size. 
// **Note:** You cannot import results from scans run more than 15 months ago.<p>Requires BASIC [16] user permissions. See [Permissions](doc:permissions).</p>

@name("Import uploaded scan") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans/import"
"Content-Type": "application/json"
? "include_aggregate"= "1"
json({
    "file": "nostrud officia commodo proident in",
    "folder_id": 98659883,
    "password": "Ut velit amet"
})


// Returns the timezones list for creating a recurring scan. For more information, see [Example Assessment Scan: Recurring](doc:example-assessment-scan-recurring).<p>Requires SCAN OPERATOR [24] user permissions. See [Permissions](doc:permissions).</p>

@name("Get timezones") : "base-inherit-auth"
GET "https://{{baseUrl}}/scans/timezones"


// Evaluates a list of targets and/or tags against the scan route configuration of scanner groups.<p>Requires SCAN OPERATOR [24] user permissions. See [Permissions](doc:permissions).</p>

@name("Test scan routes") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans/check-auto-targets"
"Content-Type": "application/json"
? "limit"= ""
? "matched_resource_limit"= ""
json({
    "network_uuid": "00000000-0000-0000-0000-000000000000",
    "tags": [
        "d8fb7fbb-903c-4b85-a884-a7d15f1fe0ef",
        "d8fb7fbb-903c-4b85-a884-a7d15f1fe0ef"
    ],
    "text_targets": "example.com, example.net, localhost"
})



