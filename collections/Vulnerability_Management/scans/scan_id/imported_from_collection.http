#!/usr/bin/env dothttp

# imported from 35240-b5ac5e35-5071-4a6b-95cc-a32753fe572d.postman_collection.json

// base-inherit-auth

@name("base-inherit-auth")
GET "https://"


// Returns scan results for a specific scan. If you submit a request without query parameters, Tenable.io returns results from the latest run of the specified scan. If you submit a request using the query parameters to specify a historical run of the scan, Tenable.io returns the scan results for the specified run. 
// 
// **Note:** Keep in mind potential [rate limits](doc:rate-limiting) and [concurrency limits](doc:concurrency-limiting) when using this endpoint. To check the status of a scan, use the [GET /scans/{scan_id}/latest-status](ref:scans-get-latest-status) endpoint. Tenable recommends the [GET /scans/{scan_id}/latest-status](ref:scans-get-latest-status) endpoint especially if you are programmatically checking the status of large numbers of scans. 
// 
// **Note:** This endpoint returns limited data if scan results are older than 35 days. Scans that are older than 35 days are effectively "archived". The `info.is_archived` attribute in the response message for this endpoint serves as the indication of archival status. For complete data from archived scan results, use the [POST /scans/{scan_id}/export](ref:scans-export-request) endpoint instead. <p>Requires SCAN OPERATOR [24] user permissions and CAN VIEW [16] scan permissions. See [Permissions](doc:permissions).</p>

@name("Get scan details") : "base-inherit-auth"
GET "https://{{baseUrl}}/scans/:scan_id"
? "history_id"= "67454373"
? "history_uuid"= "de19fad8-3fc4-eb16-cd67-d443d05a04aa"


// Updates the scan configuration. For example, you can enable or disable a scan, change the scan name, description, folder, scanner, targets, and schedule parameters. For more information and request body examples, see [Update a Scan](doc:update-scan-tio).<p>Requires SCAN OPERATOR [24] user permissions and CAN CONFIGURE [64] scan permissions. See [Permissions](doc:permissions).</p>

@name("Update scan") : "base-inherit-auth"
PUT "https://{{baseUrl}}/scans/:scan_id"
"Content-Type": "application/json"
json({
    "uuid": "ab4bacd2-05f6-425c-9d79-3ba3940ad1c24e51e1f403febe40",
    "settings": {
        "name": "cupidatat ex ullamco",
        "description": "do aliquip",
        "folder_id": -27246876,
        "owner_id": -65092824,
        "scanner_id": "00000000-0000-0000-0000-00000000000000000000000000001",
        "target_network_uuid": "00000000-0000-0000-0000-000000000000",
        "enabled": false,
        "launch": "MONTHLY",
        "scan_time_window": 46081235,
        "starttime": "20140826T133000",
        "rrules": "cillum elit ipsum",
        "timezone": "America/New_York",
        "text_targets": "localhost",
        "target_groups": [
            -76920762,
            -87918185
        ],
        "file_targets": "scan_targets.txt",
        "tag_targets": [
            "adipisicing",
            "in deseru"
        ],
        "agent_group_id": [
            "adipisicing anim occaecat",
            "aute consectetur dolore"
        ],
        "emails": "test1@test.com, test2@test.com",
        "acls": [
            {
                "permissions": 93494838,
                "owner": 83687445,
                "display_name": "sit",
                "name": "aute ipsum incididunt mollit",
                "id": 22006458,
                "type": "sunt adi"
            },
            {
                "permissions": 32234186,
                "owner": -26208721,
                "display_name": "magna voluptate",
                "name": "in U",
                "id": -70703788,
                "type": "ut eiusmod"
            }
        ]
    },
    "credentials": {
        "add": {
            "Host": {
                "Windows": [
                    {
                        "domain": "consectetur la",
                        "username": "magna",
                        "auth_method": "Password",
                        "password": "amet occaecat sunt do"
                    },
                    {
                        "domain": "mollit",
                        "username": "proident esse",
                        "auth_method": "Password",
                        "password": "ullamco laboris non Ut"
                    }
                ]
            }
        },
        "edit": {},
        "delete": [
            "qui enim",
            "ea dolor aute ut"
        ]
    },
    "plugins": {
        "Web Servers": {
            "individual": {
                "11213": "enabled",
                "18261": "enabled"
            }
        }
    }
})


// Deletes a scan.
// 
// You cannot delete scans with a `running`, `paused`, or `stopping` status. For more information, see [Scan Status](doc:scan-status-tio). <p>Requires SCAN MANAGER [40] user permissions and CAN CONFIGURE [64] scan permissions. See [Permissions](doc:permissions).</p>

@name("Delete scan") : "base-inherit-auth"
DELETE "https://{{baseUrl}}/scans/:scan_id"


// Converts scan-specific credentials to managed credentials. For more information, see [Convert Scan-specific Credentials to Managed Credentials](doc:convert-scan-specific-credentials-to-managed-credentials). <p>Requires SCAN MANAGER [40] user permissions and CAN CONFIGURE [64] scan permissions. See [Permissions](doc:permissions).</p>

@name("Convert credentials") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans/:scan_id/credentials/:credentials_id/upgrade"
"Content-Type": "application/json"
json({
    "name": "est ea sit",
    "type": "sit eiusmod veniam aliquip",
    "ad_hoc": true,
    "settings": {
        "domain": "do",
        "username": "adipisicing sit",
        "auth_method": "Password",
        "password": "in consectetur"
    },
    "category": "dolor ",
    "permissions": [
        {
            "grantee_uuid": "Lorem ea",
            "type": "user",
            "permissions": 9319128,
            "name": "in veniam proident aute commodo"
        },
        {
            "grantee_uuid": "irure esse quis",
            "type": "group",
            "permissions": -30822191,
            "name": "sunt"
        }
    ]
})


// Launches a scan. For more information, see [Launch a Scan](doc:launch-scan-tio).<p>Requires SCAN OPERATOR [24] user permissions and CAN CONTROL [32] scan permissions. See [Permissions](doc:permissions).</p>

@name("Launch scan") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans/:scan_id/launch"
"Content-Type": "application/json"
json({
    "alt_targets": [
        "quis anim Ut deserunt esse",
        "consequa"
    ]
})


// Pauses a scan. You can only pause scans that have a `running` status.<p>Requires SCAN OPERATOR [24] user permissions and CAN CONTROL [32] scan permissions. See [Permissions](doc:permissions).</p>

@name("Pause scan") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans/:scan_id/pause"


// Resumes a scan. You can only resume a scan that has a status of `paused`.<p>Requires SCAN OPERATOR [24] user permissions and CAN CONTROL [32] scan permissions. See [Permissions](doc:permissions).</p>

@name("Resume scan") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans/:scan_id/resume"


// Stops a scan. 
// 
// You can only stop a scan that has a status of `pending`, `running`, or `resuming`. For more information about these statuses, see [Scan Status](doc:scan-status-tio).<p>Requires SCAN OPERATOR [24] user permissions and CAN CONTROL [32] scan permissions. See [Permissions](doc:permissions).</p>

@name("Stop scan") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans/:scan_id/stop"


// Enables or disables a scan schedule.<p>Requires SCAN OPERATOR [24] user permissions and CAN CONTROL [32] scan permissions. See [Permissions](doc:permissions).</p>

@name("Enable schedule") : "base-inherit-auth"
PUT "https://{{baseUrl}}/scans/:scan_id/schedule"
"Content-Type": "application/json"
json({
    "enabled": false
})


// Returns the latest status for a scan. For a list of possible status values, see [Scan Status](doc:scan-status-tio).<p>Requires SCAN OPERATOR [24] user permissions and CAN VIEW [16] scan permissions. See [Permissions](doc:permissions).</p>

@name("Get latest scan status") : "base-inherit-auth"
GET "https://{{baseUrl}}/scans/:scan_id/latest-status"


// Changes the status of a scan. For a list of possible status values, see [Scan Status](doc:scan-status-tio).<p>Requires SCAN OPERATOR [24] user permissions and CAN VIEW [16] scan permissions. See [Permissions](doc:permissions).</p>

@name("Update scan status") : "base-inherit-auth"
PUT "https://{{baseUrl}}/scans/:scan_id/status"
"Content-Type": "application/json"
json({
    "read": false
})


// Copies the specified scan.<p>Requires SCAN OPERATOR [24] user permissions and CAN CONFIGURE [64] scan permissions. See [Permissions](doc:permissions).</p>

@name("Copy scan") : "base-inherit-auth"
POST "https://{{baseUrl}}/scans/:scan_id/copy"
"Content-Type": "application/json"
json({
    "folder_id": 5607922,
    "name": "pariatur nostrud minim proident"
})


// Gets the requested scan attachment file.<p>Requires SCAN OPERATOR [24] user permissions and CAN VIEW [16] scan permissions. See [Permissions](doc:permissions).</p>

@name("Get scan attachment file") : "base-inherit-auth"
GET "https://{{baseUrl}}/scans/:scan_id/attachments/:attachment_id"
? "key"= "deserunt"



